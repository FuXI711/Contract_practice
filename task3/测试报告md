forge test --match-path test/MyERC20DiffTest.sol --gas-report -vvv

存储槽合并：将 balance 和 lastTransfer 合并到一个结构体
自定义错误：比 revert 字符串节省 ~200 Gas
unchecked 块：已知安全的算术操作跳过溢出检查
类型压缩：使用 uint96 和 uint160 优化存储

src/MyERC20.sol 原始ERC20合约代码
src/MyERC20GasOpt.sol 优化后的ERC20合约代码

ERC20Test.sol 单元测试合约代码
MyERC20DiffTest.sol 差异测试合约代码
MyERC20FuzzTest.sol 模糊测试合约代码

╭----------------------------------+-----------------+-------+--------+-------+---------╮
| src/MyERC20.sol:MyERC20 Contract |                 |       |        |       |         |
+=======================================================================================+
| Deployment Cost                  | Deployment Size |       |        |       |         |
|----------------------------------+-----------------+-------+--------+-------+---------|
| 1220644                          | 7918            |       |        |       |         |
|----------------------------------+-----------------+-------+--------+-------+---------|
|                                  |                 |       |        |       |         |
|----------------------------------+-----------------+-------+--------+-------+---------|
| Function Name                    | Min             | Avg   | Median | Max   | # Calls |
|----------------------------------+-----------------+-------+--------+-------+---------|
| balanceOf                        | 2917            | 2917  | 2917   | 2917  | 769     |
|----------------------------------+-----------------+-------+--------+-------+---------|
| decimals                         | 383             | 383   | 383    | 383   | 258     |
|----------------------------------+-----------------+-------+--------+-------+---------|
| getLastTransfer                  | 2851            | 2851  | 2851   | 2851  | 256     |
|----------------------------------+-----------------+-------+--------+-------+---------|
| mint                             | 24558           | 63248 | 76135  | 76165 | 4       |
|----------------------------------+-----------------+-------+--------+-------+---------|
| transfer                         | 76507           | 76534 | 76519  | 76603 | 256     |
╰----------------------------------+-----------------+-------+--------+-------+---------╯

╭----------------------------------------------+-----------------+-------+--------+-------+---------╮
| src/MyERC20GasOpt.sol:MyERC20GasOpt Contract |                 |       |        |       |         | 
+===================================================================================================+ 
| Deployment Cost                              | Deployment Size |       |        |       |         | 
|----------------------------------------------+-----------------+-------+--------+-------+---------| 
| 1474872                                      | 9098            |       |        |       |         | 
|----------------------------------------------+-----------------+-------+--------+-------+---------| 
|                                              |                 |       |        |       |         | 
|----------------------------------------------+-----------------+-------+--------+-------+---------| 
| Function Name                                | Min             | Avg   | Median | Max   | # Calls | 
|----------------------------------------------+-----------------+-------+--------+-------+---------| 
| balanceOf                                    | 2964            | 2964  | 2964   | 2964  | 769     | 
|----------------------------------------------+-----------------+-------+--------+-------+---------| 
| decimals                                     | 383             | 383   | 383    | 383   | 2       | 
|----------------------------------------------+-----------------+-------+--------+-------+---------| 
| getLastTransfer                              | 2948            | 2948  | 2948   | 2948  | 256     | 
|----------------------------------------------+-----------------+-------+--------+-------+---------| 
| mint                                         | 24558           | 63832 | 76914  | 76944 | 4       | 
|----------------------------------------------+-----------------+-------+--------+-------+---------| 
| transfer                                     | 53033           | 53060 | 53045  | 53129 | 256     | 
╰----------------------------------------------+-----------------+-------+--------+-------+---------╯
关键指标对比
指标	        原始版本 (MyERC20)	优化版本 (MyERC20GasOpt)	变化
部署成本 (Gas)	 1,220,644	        1,474,872	               +20.8%↑
合约大小 (字节)	  7,918	             9,098	                    +14.9%↑


函数Gas对比:
函数	    原始版本	优化版本	节省Gas	    优化率
transfer	76,507	    53,033	   23,474	  30.7%↓
mint	    76,135	    76,914	   -779	      1.0%↑
balanceOf	2,917	    2,964	   -47	      1.6%↑


再次优化使用内联汇编的方式优化transfer函数，打包更多的逻辑到汇编中，减少合约调用的次数，从而节省Gas

╭----------------------------------------------+-----------------+-------+--------+-------+---------╮
| src/MyERC20GasOpt.sol:MyERC20GasOpt Contract |                 |       |        |       |         |
+===================================================================================================+
| Deployment Cost                              | Deployment Size |       |        |       |         |
|----------------------------------------------+-----------------+-------+--------+-------+---------|
| 1460780                                      | 9158            |       |        |       |         |
|----------------------------------------------+-----------------+-------+--------+-------+---------|
|                                              |                 |       |        |       |         |
|----------------------------------------------+-----------------+-------+--------+-------+---------|
| Function Name                                | Min             | Avg   | Median | Max   | # Calls |
|----------------------------------------------+-----------------+-------+--------+-------+---------|
| balanceOf                                    | 2907            | 2907  | 2907   | 2907  | 769     |
|----------------------------------------------+-----------------+-------+--------+-------+---------|
| decimals                                     | 383             | 383   | 383    | 383   | 2       |
|----------------------------------------------+-----------------+-------+--------+-------+---------|
| getLastTransfer                              | 2840            | 2840  | 2840   | 2840  | 256     |
|----------------------------------------------+-----------------+-------+--------+-------+---------|
| mint                                         | 24558           | 63708 | 76749  | 76779 | 4       |
|----------------------------------------------+-----------------+-------+--------+-------+---------|
| transfer                                     | 52774           | 52799 | 52786  | 52870 | 256     |
╰----------------------------------------------+-----------------+-------+--------+-------+---------╯

